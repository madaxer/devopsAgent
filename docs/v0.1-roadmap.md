# DevOps AI Framework v0.1 Roadmap

## Delivery Plan (4 Weeks)

## Week 1: Foundations

Build:
- Create repo structure for `client`, `agentapp`, `shared`.
- Define shared action schemas and validation.
- Implement agent health endpoint and auth middleware skeleton.
- Add local audit persistence (SQLite) with migration scripts.

Verify:
- `GET /v1/health` returns connector readiness.
- Invalid action payloads are rejected with clear errors.
- Auth-required endpoints reject missing/invalid tokens.

Exit criteria:
- Action contracts are versioned and validated server-side.

## Week 2: Read Operations

Build:
- Implement `docker.logs`, `k8s.pod_logs`, `k8s.events`, `jvm.status`, `jvm.thread_dump` executors.
- Implement `POST /v1/actions/execute` + status endpoint.
- Implement SSE streaming endpoint for long-running logs.

Verify:
- Read actions return structured summaries and raw output artifacts.
- Stream endpoint emits progress and completion states.
- Timeout and output truncation policies are enforced.

Exit criteria:
- CLI can fetch Docker and K8s logs via typed actions.

## Week 3: Write Operations + Policy Controls

Build:
- Implement `docker.restart_container`, `service.restart`, `k8s.scale_deployment`.
- Add policy engine (allowlist + RBAC + env rules).
- Add confirmation flow for risky actions.

Verify:
- Mutating actions in `stage` and `prod` require explicit confirmation.
- Denied actions return policy decision metadata and create audit entries.
- Idempotency with duplicate `request_id` works correctly.

Exit criteria:
- Safe write actions work end-to-end with audit and policy checks.

## Week 4: AI Planner + Hardening

Build:
- Add client planner adapter (start with one LLM provider, pluggable interface).
- Implement NL-to-typed-action planning with plan preview.
- Add retries, structured error codes, and observability metrics.
- Add deployment scripts for GCP VM setup.

Verify:
- Natural language prompts produce valid typed action plans.
- Confirmation UX clearly presents risk and target.
- End-to-end demo: logs, restart, and scale workflows.

Exit criteria:
- v0.1 demo-ready with one-cluster, one-agent deployment.

## Implementation Backlog by Component

Client:
- CLI command parser and output renderer.
- Planner interface (`plan(request) -> action[]`).
- Confirmation workflow for risky actions.
- Streaming output UI (tail mode).

Agent app:
- Auth middleware and token validation.
- Action registry and executor dispatcher.
- Policy evaluator and confirmation token handling.
- Audit writer and query endpoints.

Shared:
- Action schemas and enums.
- Error code taxonomy.
- Request/response DTOs and versioning strategy.

## Test Strategy

Unit tests:
- Schema validation and policy decision logic.
- Connector command builders and parsers.

Integration tests:
- Agent endpoints with mocked Docker/K8s/JVM connectors.
- Auth and RBAC behavior by environment.

End-to-end tests:
- Against a dev VM with Docker + sample app.
- Against test GKE namespace for logs and scale actions.

## Risk Register and Mitigations

Risk: Overly broad execution privileges.
- Mitigation: strict action allowlist and least-privilege service account.

Risk: Ambiguous AI plans trigger wrong targets.
- Mitigation: plan preview + required explicit target confirmation.

Risk: Log streaming causes resource pressure.
- Mitigation: per-request quotas, max stream duration, cancellation.

Risk: Production misuse.
- Mitigation: environment-based hard gates and audit alerts.

## Definition of Done for v0.1

- Typed action API implemented with validation, policy checks, and audit logging.
- Read/write action catalog implemented for Docker, K8s, JVM subset.
- CLI supports both direct action mode and AI planning mode.
- Security controls active (auth, confirmation, allowlist).
- Demo scenario documented and reproducible.


opencode -s ses_39eccb04effeNN9Nu8xecHYtdi
